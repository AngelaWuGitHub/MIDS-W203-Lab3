---
title: "Lab 3 (Bhuvnesh Sharma, Weixin Wu)"
author: "Bhuvnesh Sharma, Weixin Wu"
date: "March 22, 2018"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```





# Introduction
?????????????????????? What's the motivation of the study ????????????????????????
xxxxxxxxxxxxxxxxxxxxxx create a draft report that addresses the concerns of the political campaign
xxxxxxxxxxxxxxxxxxxxxx What do you want to measure? Make sure you identify variables that will be relevant to the concerns of the political campaign





# Data Cleansing

```{r}
crimeData <- read.csv("crime_v2.csv")
summary(crimeData)
```


As shown in the summary table, there are 6 NA's in every variable. 
After reviewing the data, we found that all NA's are in 6 rows, so we removed those rows as they did not provide any information.
```{r}
crimeData2 <- crimeData[complete.cases(crimeData),]
```


Variable 'prbconv' was incorrectly displayed as a text field. We converted it to numermic.
```{r}
crimeData2 <- transform(crimeData2, prbconv = as.numeric(as.character(prbconv)))
summary(crimeData2$prbconv)
```


Usually the probability variable should be bound between 0 and 1.
However, there is one observation with 'prbarr' (probability of arrest) higher than 1, 
and 10 observations with 'prbconv' (probability of conviction) higher than 1.
```{r}
nrow(crimeData2[which(crimeData2$prbarr>1),])
nrow(crimeData2[which(crimeData2$prbconv>1),])
```
Variable 'prbarr' is defined as the ratio of arrests to offenses. 
One possible explanation for 'prbarr' being greater than 1 is that 
multiple people who convicted a single crime together is counted as one conviction but multiple arrests.   
Variable 'prbconv' is defined as the ratio of convictions to arrests.
One possible explanation for 'prbconv' being greater than 1 is that 
one person who is convicted of multiple crimes but only arrested once.   
Without further information on the variables, we could not conclude whether these values are valid.
So we left those observations in the data.


Variable 'pctmin80' (percent of minority in 1980) is expressed as percentages. 
We converted it into decimals to be consistent with variable 'pctymle' (percent of young male).
```{r}
crimeData2$pctmin80_2 <- crimeData2$pctmin80/100
```


The max value of variable 'wser' (weekly wage of service industry) is significantly higher than its third quartile.
The histogram below shows that the max value (2177.068) is significantly higher than the rest of values.
```{r}
hist(crimeData2$wser)
crimeData2[which(crimeData2$wser>2000),]
```
We examined County 185, whose wser is 2177.068.
We noticed that most other weekly wage variables for County 185 are below the means.
You would expect that a richer county would have weekly wage in multiple industries to be higher than the average.
So it's very unlikely for a county to have lower than average weekly wage on constructure, transportation, retail, finance, etc. 
but extremely high weekly wage on the service industry.
xxxxxxxxxxxxxxxxxxxxxxxxx Option 1: xxxxxxxxxxxxxxxxxxxxxxxxxx
In addition, an average weekly wage of 2177.068 in 1987 is an unreasonable value.
So we believed 2177.068 is erroneous.
We removed this value from the data.
xxxxxxxxxxxxxxxxxxxxxxxxx Option 2: xxxxxxxxxxxxxxxxxxxxxxxxxx
So it's possible that the value of 2177.068 is erroneous. 
Unfortunately, we don't have additional information to verify this entry.
If variable 'wser' is in the model, this data point will be highly leveraged and could potentially be influential.
We will examine the Cook's distance later in the modeling session to identify influential data points.





# EDA
```{r}
hist(crimeData2$crmrte)
hist(crimeData2$wser)
```
histogram + correlation graph => bin? transformation?
Bhuvnesh: prbarr - pctmin80
Angela: wcon - pctmle
meet 4pm CST tomorrow
due Monday 8pm CST














```{r}
library(car)
crimeData3 <- crimeData2[which(crimeData2$wser<2000),]
scatterplotMatrix(~ crmrte+wcon+wtuc, data=crimeData2, diagonal="histogram")
scatterplotMatrix(~ crmrte+wtrd+wfir, data=crimeData2, diagonal="histogram")
scatterplotMatrix(~ crmrte+wser+wmfg, data=crimeData2, diagonal="histogram")
scatterplotMatrix(~ crmrte+wser+wmfg, data=crimeData3, diagonal="histogram")
scatterplotMatrix(~ crmrte+wfed+wsta+wloc, data=crimeData2, diagonal="histogram")
scatterplotMatrix(~ crmrte+mix+pctymle, data=crimeData2, diagonal="histogram")
```
I think I would delete wser = 2177.068 because it significantly distorted the trend.
wmfg has a weird shape.
wsta has a weird flat then increase trend.
not sure how to interpret the variable 'mix'
pctymle has one extreme value as well. This data point is highly leveraged and could potentially be influential.
Most other variables look like they have linear relationships with crmrte.

```{r}
crimeData3[which(crimeData2$pctymle>0.1),]
```









# Model Building 1
```{r}
step(lm(crmrte ~ prbarr+prbconv+prbpris+avgsen+polpc+density+taxpc+west+central+urban+pctmin80_2+wcon+wtuc+wtrd+wfir+wser+wmfg+wfed+wsta+wloc+mix+pctymle, data=crimeData2), direction="both")
```


# Model Building 2



# Model Building 3



# Model Display



# Omitted Variables
