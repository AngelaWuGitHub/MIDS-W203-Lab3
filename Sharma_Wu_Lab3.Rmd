---
title: "Lab 3 (Bhuvnesh Sharma, Weixin Wu)"
author: "Bhuvnesh Sharma, Weixin Wu"
date: "March 22, 2018"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
crimeData <- read.csv("crime_v2.csv")
summary(crimeData)
```





# Data Cleansing

As shown in the summary table, there are 6 NA's in every variable. 
After reviewing the data, we found that all NA's are in 6 rows, so we remove those rows as they do not provide any information.
```{r}
crimeData2 <- crimeData[complete.cases(crimeData),]
```


Variable 'prbconv' is incorrectly displayed as a text field. We convert it to numermic.
```{r}
crimeData2 <- transform(crimeData2, prbconv = as.numeric(as.character(prbconv)))
summary(crimeData2$prbconv)
```


Usually the probability variable should be bound between 0 and 1.
However, variables 'prbarr' (probability of arrest) and 'prbconv' (probability of conviction) has some observations with values greater than 1.
```{r}
crimeData2[which(crimeData2$prbarr>1),]
```
```{r}
crimeData2[which(crimeData2$prbconv>1),]
```
why prbarr > 1: multiple people can be convincted of one crime but counted as multiple arrests.
why prbconv > 1: one possibility is that one person can be convincted on multiple crimes while once arrested once?
```{r}
hist(crimeData2$prbarr)
hist(crimeData2$prbconv)
```




Variable 'pctmin80' (percent of minority in 1980) is expressed as percentages. 
We convert it into decimals to be consistent with variable 'pctymle' (percent of young male).
```{r}
crimeData2$pctmin80_2 <- crimeData2$pctmin80/100
```


The max value of variable 'wser' (weekly wage of service industry) is significantly higher than its third quartile.
The histogram below shows that the max value (2177.068) is significantly higher than the rest of values.
```{r}
hist(crimeData2$wser)
crimeData2[which(crimeData2$wser>2000),]
```
By examining the county 185, whose wser is 2177.068, we find that all the other weekly wage variables for the county is within a normal range.
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
So it's possible that the value of 2177.068 is erroneous. 
Unfortunately, we don't have additional information to verify this entry.
If variable 'wser' is in the model, this data point will be highly leveraged and could potentially be influential.
We will examine the Cook's distance later in the modeling session to identify influential data points.





# EDA
```{r}
hist(crimeData2$crmrte)
hist(crimeData2$wser)
```
histogram + correlation graph => bin? transformation?
Bhuvnesh: prbarr - pctmin80
Angela: wcon - pctmle
meet 4pm CST tomorrow
due Monday 8pm CST



# Model Building 1
```{r}
step(lm(crmrte ~ prbarr+prbconv+prbpris+avgsen+polpc+density+taxpc+west+central+urban+pctmin80_2+wcon+wtuc+wtrd+wfir+wser+wmfg+wfed+wsta+wloc+mix+pctymle, data=crimeData2), direction="both")
```


# Model Building 2



# Model Building 3



# Model Display



# Omitted Variables
